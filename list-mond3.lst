Rolf-D.Klein 68000/08 Assembler 4.3 (C) 1984, Seite 1

                        
0E9C00                  ;* MONDLANDEPROGRAMM MIT JOYSTICK
0E9C00                  ;* UND MONDFLAECHE MIT EBENEM LANDEPLATZ
0E9C00                   
009C00                   ORG $9C00
009C00                   
009C00                  ; ***** VEREINBARUNGS-BAUSTEIN *****
009C00                   
= FFFFFF30              TASTEN EQU $FFFFFF30
= 00000003              RECHTS EQU 3
= 00000002              LINKS  EQU 2
= 00000001              RAUF   EQU 1
= 00000000              RUNTER EQU 0
= 00000004              FEUER  EQU 4
009C00                   
009C00                  ERFOLGTEXT:
009C00  4775742067656C   DC.B 'Gut gelandet',0
009C07  616E64657400    
009C0D                   
009C0D                  BRUCHTEXT:
009C0D  42727563686C61   DC.B 'Bruchlandung',0
009C14  6E64756E6700    
009C1A                   
009C1A                  FAEHRE:
009C1A  00 01 01 00 00   DC.B 0,1,1,0,0,0,0,0,7,7,0,4,3,3
009C1F  00 00 00 07 07  
009C24  00 04 03 03     
009C28  02 04 04 04 04   DC.B 2,4,4,4,4,4,6,2,0
009C2D  04 06 02 00     
009C31  03 02 02 02 01   DC.B 3,2,2,2,1,0,0,0,7,6,6,6,5,10
009C36  00 00 00 07 06  
009C3B  06 06 05 0A     
009C3F  00               DS 0                   ; ANGLEICH AUF WORTLAENGE
009C40                   
= 00000021              FBREITE EQU 11*3        ; BREITE DER FAEHRE
009C40                   
009C40                  LANDSCHAFT:             ; Y-KOORDINATEN, DER FLAECHE
009C40                                          ; DIE X-KOORDINATEN LAUFEN IN 10ER SCHRITTEN
009C40  0000 000A 000F   DC.W 0,10,15,25,45,40,50,35,30,35,50,65,60,60,50,40,25,20,20
009C46  0019 002D 0028  
009C4C  0032 0023 001E  
009C52  0023 0032 0041  
009C58  003C 003C 0032  
009C5E  0028 0019 0014  
009C64  0014            
009C66  0019 0028 0032   DC.W 25,40,50,45,40,40,40,40,40,40,45,40,30,45,60,75
009C6C  002D 0028 0028  
009C72  0028 0028 0028  
009C78  0028 002D 0028  
009C7E  001E 002D 003C  
009C84  004B            
009C86  004B 003C 0032   DC.W 75,60,50,35,30,20,30,15,20,15,25,10,15,5,0,0
009C8C  0023 001E 0014  
009C92  001E 000F 0014  
009C98  000F 0019 000A  
009C9E  000F 0005 0000  
009CA4  0000            
= 00000033              ANZLAND EQU (*-LANDSCHAFT)/2     ; HALBE WEGEN WORT
009CA6                   
009CA6                  ; VARIABLENVEREINBARUNGEN
009CA6                   
009CA6  0000            X: DC.W     0
009CA8  0000            Y: DC.W     0
009CAA  0000            DX: DC.W    0
Rolf-D.Klein 68000/08 Assembler 4.3 (C) 1984, Seite 2

009CAC  0000            DY: DC.W    0
009CAE  0000            TREIBST: DC.W   0
009CB0  0000            HX: DC.W     0
009CB2  0000            HY: DC.W     0
009CB4  0000            DHX: DC.W    0
009CB6  0000            DHY: DC.W    0
009CB8                  ; ***** UNTERPROGRAMM-BAUSTEIN *****
009CB8                  MONDFLAECHE:
009CB8  4241             CLR D1
009CBA  4242             CLR D2
009CBC  4EB9 000E0EE2    JSR @MOVETO    ; DORT ANFANGEN
009CC2  41F9 00009C40    LEA LANDSCHAFT,A0
009CC8  363C 0032        MOVE #ANZLAND-1,D3
009CCC                  MONDLP:
009CCC  3418             MOVE (A0)+,D2
009CCE  4EB9 000E0F4C    JSR @DRAWTO
009CD4  0641 000A        ADD #10,D1
009CD8  51CB FFF2        DBRA D3,MONDLP
009CDC  4E75             RTS
009CDE                   
009CDE                  LASER:          ; LASERSTRAHL-FORM
009CDE  3239 00009CB0    MOVE HX,D1
009CE4  3439 00009CB2    MOVE HY,D2
009CEA  4EB9 000E0EE2    JSR @MOVETO
009CF0  0641 0019        ADD #25,D1
009CF4  4EB9 000E0F4C    JSR @DRAWTO
009CFA  4E75             RTS
009CFC                   
009CFC                  LASEREXEC:      ; LASER NEU AUSGEBEN
009CFC  4A79 00009CB2    TST HY
009D02  6700 0036        BEQ WDH12
009D06                  ; LOESCHEN ALTE POS
009D06  4EB9 000E0D6E    JSR @ERAPEN
009D0C  6100 FFD0        BSR LASER
009D10  0679 000A        ADD #10,HY
009D14  00009CB2        
009D18  4EB9 000E0D7C    JSR @SETPEN
009D1E  6100 FFBE        BSR LASER
009D22  0C79 0200        CMP #512,HX
009D26  00009CB0        
009D2A  6500 000E        BCS WDH12
009D2E  4279 00009CB2    CLR HY
009D34  4279 00009CB0    CLR HX         ; STOP
009D3A                  WDH12:
009D3A                  *
009D3A  4E75             RTS
009D3C                   
009D3C                  CHECKHOEHE:     ; Y IN ABHAENGIGKEIT VON X
009D3C                                  ; D0=FFFF, WENN OK, SONST 0
009D3C  3239 00009CA6    MOVE X,D1
009D42  6B00 0072        BMI NOTOK      ; AUSSERHALB DES BILDSCHIRMS
009D46  0C41 0200        CMP #512,D1
009D4A  6E00 006A        BGT NOTOK      ; IMMER BRUCH
009D4E  3439 00009CA8    MOVE Y,D2
009D54  6100 001C        BSR CHECK1     ; ZUERST LINKER AUFSETZPUNKT
009D58  6700 005C        BEQ NOTOK      ; NEIN, DANN UNTER OBERFLAECHE
009D5C  3239 00009CA6    MOVE X,D1
009D62  3439 00009CA8    MOVE Y,D2
009D68  0641 0021        ADD #FBREITE,D1 ; NUN FUER RECHTE SEITE PRUEFEN
009D6C  6100 0004        BSR CHECK1
009D70  4E75             RTS
009D72                   
009D72                  CHECK1:         ; X=D1, Y=D2, PRUEFT HOEHE
009D72  3601             MOVE D1,D3     ; TABELLENEINTRAG FINDEN
Rolf-D.Klein 68000/08 Assembler 4.3 (C) 1984, Seite 3

009D74  48C3             EXT.L D3       ; DAZU DURCH 10 DIVIDIEREN
009D76  86FC 000A        DIVU #10,D3    ; UND ALS WORT HOLEN
009D7A  43F9 00009C40    LEA LANDSCHAFT,A1
009D80  D2C3             ADDA.W D3,A1
009D82  D2C3             ADDA.W D3,A1   ; 2* ADDIEREN, DA WORT
009D84  3611             MOVE (A1),D3   ; Y1
009D86  9669 0002        SUB 2(A1),D3   ; Y1-Y2
009D8A  3801             MOVE D1,D4 
009D8C  48C4             EXT.L D4
009D8E  88FC 000A        DIVU #10,D4    ; ERST MAL X1 BERECHNEN
009D92  C8FC 000A        MULU #10,D4
009D96  0644 000A        ADD #10,D4     ; DA 10ER ABSTAND   =X2
009D9A  9841             SUB D1,D4      ; IST X2-X
009D9C  C7C4             MULS D4,D3     ; (Y2-Y1)*(X2-X)
009D9E  87FC 000A        DIVS #10,D3    ; = YSA
009DA2  D669 0002        ADD 2(A1),D3   ; IST  YS  HOEHE DES SCHNITTPUNKTES
009DA6  B642             CMP D2,D3
009DA8  6F00 0006        BLE OKCHECK
009DAC  6000 0008        BRA NOTOK
009DB0                   
009DB0                  OKCHECK:
009DB0  303C FFFF        MOVE #$FFFF,D0
009DB4  4E75             RTS
009DB6                  NOTOK:
009DB6  4240             CLR D0
009DB8  4E75             RTS
009DBA                   
009DBA                  ; ***** PROGRAMM-BAUSTEIN *****
009DBA                  START:
009DBA  6100 FEFC        BSR MONDFLAECHE
009DBE  33FC 0064        MOVE #100,X
009DC2  00009CA6        
009DC6  33FC 00C8        MOVE #200,Y
009DCA  00009CA8        
009DCE  33FC 0003        MOVE #3,DX
009DD2  00009CAA        
009DD6  33FC 0000        MOVE #0,DY
009DDA  00009CAC        
009DDE  33FC 012C        MOVE #300,TREIBST
009DE2  00009CAE        
009DE6                   
009DE6                  WDH1:
009DE6  207C 00009C1A    MOVEA.L #FAEHRE,A0
009DEC  303C 0003        MOVE #3,D0        ; BERGRIESSERUNG=3
009DF0  3239 00009CA6    MOVE X,D1
009DF6  3439 00009CA8    MOVE Y,D2
009DFC  4EB9 000E328C    JSR @FIGUR
009E02  4A79 00009CAE    TST TREIBST
009E08  6F00 006A        BLE NOTEST         ; KEIN TREIBSTOFF?
009E0C  1039 FFFFFF30    MOVE.B TASTEN,D0
009E12  0800 0003        BTST #RECHTS,D0
009E16  6606             BNE.S TST1
009E18  5679 00009CAA    ADDQ #3,DX
009E1E                  TST1: 
009E1E  0800 0002        BTST #LINKS,D0
009E22  6606             BNE.S TST2
009E24  5779 00009CAA    SUBQ #3,DX
009E2A                  TST2:
009E2A  0800 0001        BTST #RAUF,D0
009E2E  6606             BNE.S TST3
009E30  5679 00009CAC    ADDQ #3,DY
009E36                  TST3:
009E36  0800 0000        BTST #RUNTER,D0
009E3A  6606             BNE.S TST4
Rolf-D.Klein 68000/08 Assembler 4.3 (C) 1984, Seite 4

009E3C  5779 00009CAC    SUBQ #3,DY
009E42                  TST4:
009E42  0800 0004        BTST #FEUER,D0
009E46  662C             BNE.S TST5
009E48  4A79 00009CB2    TST HY
009E4E  6624             BNE.S TST5
009E50  33F9 00009CA6    MOVE X,HX
009E56  00009CB0        
009E5A  33F9 00009CA8    MOVE Y,HY
009E60  00009CB2        
009E64  0679 0014        ADD #20,HX
009E68  00009CB0        
009E6C  0679 0014        ADD #20,HY
009E70  00009CB2        
009E74                   
009E74                  TST5:
009E74                  NOTEST:
009E74  5379 00009CAC    SUBQ #1,DY         ; GRAVITATION
009E7A  3639 00009CAA    MOVE DX,D3         ; X:=X+DX
009E80  D779 00009CA6    ADD D3,X
009E86  3639 00009CAC    MOVE DY,D3         ; Y:=Y+DY
009E8C  D779 00009CA8    ADD D3,Y
009E92  5379 00009CAE    SUBQ #1,TREIBST    ; TREIBSTOFF VERRINGERN
009E98  323C 0031        MOVE #50-1,D1       ; WARTESCHLEIFE
009E9C                  WARTE20MS:
009E9C  4EB9 000E0E38    JSR @SYNC
009EA2  6700 FFF8        BEQ WARTE20MS
009EA6  3F01             MOVE D1,-(A7)
009EA8  6100 FE52        BSR LASEREXEC
009EAC  321F             MOVE (A7)+,D1
009EAE  51C9 FFEC        DBRA D1, WARTE20MS
009EB2  6100 FE88        BSR CHECKHOEHE     ; HIER IN ABH. VON X PRUEFEN
009EB6  6600 FF2E        BNE WDH1           ; WENN <> 0 DANN OK
009EBA  303C 0003        MOVE #3,D0         ; SONST AM BODEN
009EBE  3239 00009CA6    MOVE X,D1          ; FIGUR ABER ERST MAL DARSTELLEN
009EC4  3439 00009CA8    MOVE Y,D2
009ECA  4EB9 000E328C    JSR @FIGUR
009ED0  4EB9 000E3286    JSR @SETFIG
009ED6  3039 00009CA6    MOVE X,D0          ; PRUEFEN OB IM LANDEGEBIET
009EDC  0C40 00E6        CMP #230,D0        ; BEI UNS XMIN=230
009EE0  6D00 003E        BLT BRUCH          ; NEIN, DANN BRUCH
009EE4  0640 0021        ADD #FBREITE,D0    ; ODER RECHTS ZU WEIT ?
009EE8  0C40 0118        CMP #280,D0
009EEC  6E00 0032        BGT BRUCH          ; DANN AUCH BRUCH
009EF0  3039 00009CAA    MOVE DX,D0         ; BESCHLEUNIGUNG TESTEN
009EF6  6A02             BPL.S FF1
009EF8  4440             NEG D0
009EFA                  FF1:                ; !DX! < 2
009EFA  0C40 0002        CMP #2,D0
009EFE  6C00 0020        BGE BRUCH
009F02  3039 00009CAC    MOVE DY,D0
009F08  6A00 0004        BPL FF2
009F0C  4440             NEG D0
009F0E                  FF2:                ; !DY! < 4 
009F0E  0C40 0004        CMP #4,D0
009F12  6C00 000C        BGE BRUCH
009F16  41F9 00009C00    LEA ERFOLGTEXT,A0
009F1C  6000 0008        BRA ENDE
009F20                   
009F20                  BRUCH:
009F20  41F9 00009C0D    LEA BRUCHTEXT,A0
009F26                  ENDE:
009F26  303C 0033        MOVE #$33,D0       ; SCHRIFTGROESSE
009F2A  4241             CLR D1             ; X-POSITION
Rolf-D.Klein 68000/08 Assembler 4.3 (C) 1984, Seite 5

009F2C  343C 0082        MOVE #130,D2       ; Y-POSITION
009F30  4EB9 000E1386    JSR @WRITE
009F36  4EB9 000E0A00    JSR @CI            ; WARTEN AUF TASTE
009F3C  4EB9 000E0DA0    JSR @CLR           ; LOESCHEN
009F42  6000 FE76        BRA START          ; UNBEGRENZT
009F46                   
009F46                  ; **********
009F46                   
009F46                  END

0E8D66  Ende-Symboltabelle
